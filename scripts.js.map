{"version":3,"sources":["src/service-worker.js"],"names":[],"mappings":"AAAA;;AAEA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,0BAA0B;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,K;;AAEA;AACA,C","file":"scripts.js","sourcesContent":["//importScripts('./ngsw-worker.js');\r\n\r\nself.addEventListener('sync', (event) => {\r\n  if (event.tag === 'post-data') {\r\n    // call method\r\n    event.waitUntil(getDataAndSend());\r\n  }\r\n});\r\n\r\nfunction addData(nota) {\r\n  let obj = {\r\n    titulo: nota.titulo,\r\n    message: nota.message,\r\n    color: nota.color \r\n  };\r\n  fetch('https://monitoramento-backend.herokuapp.com/anotacao', {\r\n    method: 'POST',\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n    },\r\n    body: JSON.stringify(obj),\r\n  })\r\n    .then(() => Promise.resolve())\r\n    .catch(() => Promise.reject());\r\n}\r\n\r\nfunction getDataAndSend() {\r\n  let db;\r\n  const request = indexedDB.open('db-motin');\r\n  request.onerror = (event) => {\r\n    console.log('Please allow my web app to use IndexedDB ðŸ˜ƒ>>>ðŸ‘»');\r\n  };\r\n  request.onsuccess = (event) => {\r\n    db = event.target.result;\r\n    getData(db);\r\n  };\r\n}\r\n\r\nfunction getData(db) {\r\n\r\n   console.log(\"getData-10\");\r\n   console.log(\"Event\");\r\n  const transaction = db.transaction(['notas']);\r\n  const objectStore = transaction.objectStore('notas');\r\n  const reqkey = objectStore.getAllKeys();\r\n  reqkey.onerror = (event) => {\r\n    // Handle errors!\r\n    console.error(event);\r\n  };\r\n  reqkey.onsuccess = (event) => {\r\n    // Do something with the request.result!\r\n    console.log(reqkey.result);\r\n    for (let i = 0; i < reqkey.result.length; i++) {\r\n      seq = reqkey.result[i];\r\n      console.log (seq);\r\n      const reqObject  = objectStore.get(seq);\r\n      reqObject.onerror = (event) => {\r\n        // Handle errors!\r\n        console.error(event);\r\n      };\r\n      reqObject.onsuccess = (event) => {\r\n        console.log(reqObject.result);\r\n        addData(reqObject.result);\r\n        console.log('delete seq: '+seq);\r\n\r\n        const trans = db.transaction([\"notas\"], \"readwrite\");\r\n        const store = trans.objectStore(\"notas\");\r\n        const reqDelete = store.delete(seq);\r\n        \r\n        reqDelete.onerror = (event) => {\r\n          // Handle errors!\r\n          console.error(event);\r\n        };\r\n        reqDelete.onsuccess = (event) => {\r\n          // Handle errors!\r\n          console.log('delete sucess: '+seq);\r\n        };\r\n\r\n       };\r\n    } \r\n \r\n  };\r\n}"],"sourceRoot":"webpack:///"}